# 第六課的重點筆記

## **進階 SQL 功能與應用**

1. 多表操作
2. 子查詢（非相關和相關）
3. 動態和具體化視圖
4. 資料庫觸發器和儲存程序
5. SQL 標準（2011 和 2016）擴展功能

---

## **多表操作與 JOIN**

- **Equi-join**: 依據相同欄位值進行連接。
- **Natural join**: 與 equi-join 相似，但排除重複欄位。
- **Outer join**: 包括無匹配值的記錄（如 Left Outer Join）。
- **Union join**: 包括兩表中的所有資料。

---

## **子查詢 (Subqueries)**

- **定義**：在查詢中嵌套另一個 SELECT 語句。
- **類型**：
  - **非相關子查詢**：獨立執行一次，結果供外部查詢使用。
  - **相關子查詢**：對外部查詢的每一行執行一次。
- **用途**：
  - `WHERE`、`FROM`、`SELECT` 和 `HAVING` 中可用。

---

## **視圖 (Views)**

- **動態視圖**：即時生成，不儲存資料，基於基礎表。
- **具體化視圖**：儲存數據的副本，需要定期刷新。
- **優點**：
  - 簡化查詢，提升資料安全性。
  - 減少儲存空間需求。
  - 提供用戶自定義的資料視角。

---

## **觸發器與儲存程序**

- **觸發器 (Triggers)**：因特定事件（如插入、更新、刪除）自動執行。
- **儲存程序 (Stored Procedures)**：
  - **函數 (Functions)**：返回值。
  - **程序 (Procedures)**：無返回值，可接受輸入或輸出參數。
- **用途**：
  - 自動化操作，提升系統一致性。

---

## **查詢效率與設計建議**

1. 避免 `SELECT *`，僅選擇所需欄位。
2. 減少子查詢，盡量合併為單一查詢。
3. 善用索引以優化查詢性能。
4. 使用臨時表處理多重查詢。
5. 儘量簡化查詢結構，必要時分解為多部分。

---

## **SQL 擴展功能**

1. 自定義資料類型 (User-Defined Data Types)。
2. 新增資料類型：`BIGINT`、`XML` 等。
3. 分析函數：`RANK`、`DENSE_RANK`、`ROLLUP`、`CUBE`。
4. 新增控制流語句：`CASE`、`IF`、`LOOP`。
5. SQL 作為程序語言（如 PL/SQL、Transact-SQL）。
