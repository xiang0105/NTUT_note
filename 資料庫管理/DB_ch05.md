# **第 5 章：物理資料庫設計與效能**

## **學習目標**

1. 定義 SQL 和相關術語。
2. 理解 SQL 在資料庫發展中的歷史與角色。
3. 使用 SQL 資料定義語言 (DDL) 創建資料庫。
4. 撰寫單表查詢的 SQL 指令。
5. 建立資料參考完整性。
6. 討論 SQL:1999 和 SQL:2016 標準。

---

## **SQL 概述**

- **SQL** (Structured Query Language)：關聯式資料庫管理系統的標準語言。
- **RDBMS**：管理資料表集合，通過關聯欄位表示關係。

---

## **SQL 的歷史**

- 1970年：E.F. Codd 提出關聯式資料庫概念。
- 1974-1979年：IBM 開發 Sequel（後來稱為 SQL）。
- 1986年：ANSI 發布 SQL 標準。
- 目前：SQL 成為大多數主流資料庫供應商的標準語言。

---

## **SQL 環境**

- **Catalog**：資料庫的描述集合。
- **Schema**：包含使用者建立物件的結構描述。
- **語言分類**：
  - **DDL**：資料定義語言，用於創建、修改表和約束。
  - **DML**：資料操作語言，用於維護和查詢資料庫。
  - **DCL**：資料控制語言，用於管理權限和提交數據。

---

## **SQL 資料型別**

- 字串：`CHARACTER`、`VARCHAR`
- 數值：`NUMERIC`、`INTEGER`
- 時間：`TIMESTAMP`
- 布林：`BOOLEAN`

---

## **資料庫定義 (DDL)**

1. **主要 CREATE 指令**：
   - `CREATE SCHEMA`：定義特定使用者的資料庫部分。
   - `CREATE TABLE`：定義新表及其欄位。
   - `CREATE VIEW`：基於一個或多個表創建邏輯表。
2. **表建立步驟**：
   - 確定資料型別與欄位是否可為空。
   - 定義主鍵與外鍵關係。
   - 設置預設值與約束條件。

---

## **資料完整性**

- **參考完整性**：確保外鍵值匹配相關表的主鍵。
  - **限制操作**：避免刪除或更新主表時破壞關係。

---

## **基本 SQL 操作**

- **INSERT**：新增資料列。
- **DELETE**：刪除資料列。
- **UPDATE**：修改現有資料。
- **MERGE**：結合插入與更新操作，適合更新主表。

---

## **查詢 (SELECT)**

- **主要子句**：
  - `SELECT`：指定返回的欄位。
  - `FROM`：指定數據來源表。
  - `WHERE`：指定篩選條件。
  - `GROUP BY`：對結果進行分組。
  - `HAVING`：針對分組結果篩選。
  - `ORDER BY`：對結果排序。
- **布林運算子**：`AND`、`OR`、`NOT` 支援條件組合。

---

## **查詢優化建議**

1. 使用索引來提高查詢效率。
2. 避免 SELECT *，只提取必要欄位。
3. 適當拆分複雜查詢。
4. 定期更新統計數據。
